<!DOCTYPE html>
<html>

<head>
    <title>能耗结构</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" id='theme' href="css/theme-dark-blue.css" />
</head>

<body>
    <div class="page-container">
        <a href="# " class="x-navigation-minimize menu_minimalize"><span class="arrow arrow-shrink "></span></a>
        <div class="page-sidebar page-sidebar-fixed scroll">
            <ul id='menu' class="x-navigation">
                <li class="xn-logo">
                    <a href="index.html"></a>
                    <a href='#' class="x-navigation-control "></a>
                </li>
            </ul>
        </div>
        <div class="page-content ">
            <h3 class="page-title">
                <ul class="x-navigation x-navigation-horizontal log-out pull-right">
                    <li class="xn-icon-button last ">
                        <a href="# "><span class="fa fa-power-off "></span></a>
                        <ul class="xn-drop-left animated zoomIn ">
                            <li><a href="# " class="mb-control " data-box="#mb-signout "><span class="fa fa-sign-out "></span> 登出</a></li>
                        </ul>
                    </li>
                </ul>
                能耗结构</h3>
            <div class="page-content-wrap chart_container">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="panel_title">
                                <div class="col-lg-3 col-md-3">
                                    <h4>总量消耗结构</h4>
                                </div>
                                <div class="col-lg-9 col-md-9 clearfix">
                                    <div class="gap-btn-group pull-right bar-group" role="group">
                                        <div class="btn-group" role="group">
                                            <select class="w140 form-control select iselect selectDate selectDate1">
                                                <option value="1">按月查询</option>
                                                <option value="2">按年查询</option>
                                            </select>
                                        </div>
                                        <div class="btn-group datebox1" role="group">
                                            <input id="date_input1_1" type="text" class="form-control laydate-icon layer-date w140">
                                        </div>
                                        <div class="btn-group datebox2 hidden-em" role="group">
                                            <input id="date_input1_2" type="text" class="form-control laydate-icon layer-date w140">
                                        </div>
                                        <button id="ser1" type="button" title="搜索" class="btn btn-outline btn-primary">
                                            <span>查询</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="iPanel">
                                <div class="content clearfix" style="min-height: 329px;">
                                    <div class="chart-wrap">
                                        <div id="total_bar"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-6">
                            <div class="panel_title clearfix">
                                <div class="col-lg-3 col-md-3">
                                    <h4>区域消耗结构</h4>
                                </div>
                                <div class="col-lg-9 col-md-9 clearfix">
                                    <div class="gap-btn-group pull-right bar-group" role="group">
                                        <div class="btn-group" role="group">
                                            <select class="w140 form-control select iselect selectDate selectDate3">
                                                <option value="1">按月查询</option>
                                                <option value="2">按年查询</option>
                                            </select>
                                        </div>
                                        <div class="btn-group datebox1" role="group">
                                            <input id="date_input3_1" type="text" class="form-control laydate-icon layer-date w140">
                                        </div>
                                        <div class="btn-group datebox2 hidden-em" role="group">
                                            <input id="date_input3_2" type="text" class="form-control laydate-icon layer-date w140">
                                        </div>
                                        <div class="btn-group" role="group">
                                            <select id="energyType2" class="w140 form-control select iselect"> </select>
                                        </div>
                                        <button id="ser3" type="button" title="搜索" class="btn btn-outline btn-primary">
                                            <span>查询</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="iPanel">
                                <div class="content clearfix" style="min-height: 280px;">
                                    <div class="col-lg-6">
                                        <div class="chart-wrap">
                                            <div id="ring"></div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6" style="min-height: 280px; position: relative;">
                                        <div id="legend_ring" class="detail">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-6">
                            <div class="panel_title clearfix">
                                <div class="col-lg-3 col-md-3">
                                    <h4>行业消耗结构</h4>
                                </div>
                                <div class="col-lg-9 col-md-9 clearfix">
                                    <div class="gap-btn-group pull-right bar-group" role="group">
                                        <div class="btn-group" role="group">
                                            <select class="w140 form-control select iselect selectDate selectDate2">
                                                <option value="1">按月查询</option>
                                                <option value="2">按年查询</option>
                                            </select>
                                        </div>
                                        <div class="btn-group datebox1" role="group">
                                            <input id="date_input2_1" type="text" class="form-control laydate-icon layer-date w140">
                                        </div>
                                        <div class="btn-group datebox2 hidden-em" role="group">
                                            <input id="date_input2_2" type="text" class="form-control laydate-icon layer-date w140">
                                        </div>
                                        <div class="btn-group" role="group">
                                            <select id="energyType1" class="w140 form-control select iselect"></select>
                                        </div>
                                        <button id="ser2" type="button" title="搜索" class="btn btn-outline btn-primary">
                                            <span>查询</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="iPanel">
                                <div class="content clearfix" style="min-height: 280px;">
                                    <div class="col-lg-6">
                                        <div class="chart-wrap useNoData">
                                            <div id="pie"></div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6" style="min-height: 280px; position: relative;">
                                        <div id="legend_pie" class="detail">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="message-box animated fadeIn" data-sound="alert " id='mb-signout'>
        <div class="mb-container ">
            <div class="mb-middle ">
                <div class="mb-title"><span class="fa fa-sign-out "></span> Log <strong>Out</strong> ?</div>
                <div class="mb-content ">
                    <p>确定登出?</p>
                    <p>如果您想继续留在此页面，请点击"否"</p>
                </div>
                <div class="mb-footer ">
                    <div class="pull-right ">
                        <a href="login.html " class="btn btn-success btn-lg ">是</a>
                        <button class="btn btn-default btn-lg mb-control-close ">否</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script type='text/javascript' src="js/import.js"></script>
<script type='text/javascript' src="js/pages/common.js"></script>
<script type='text/javascript' src="js/pages/CURDTable.js"></script>
<script type='text/javascript' src="js/charts/echart_yarn.min.js"></script>
<script>
    var type1 = $('.selectDate1').val();
    var type2 = $('.selectDate2').val();
    var type3 = $('.selectDate3').val();

    $('.selectDate').change(function() {
        type1 = $(this).val();
        type2 = $(this).val();
        type3 = $(this).val();

        if ($(this).val() == 1) {
            $(this).parent().siblings('.datebox1').show();
            $(this).parent().siblings('.datebox2').hide();
        } else {
            $(this).parent().siblings('.datebox2').show();
            $(this).parent().siblings('.datebox1').hide();
        }
    });

    function showTotal(type, date) {
        new yarn({
            charts: [{
                el: 'total_bar',
                type: 'bar',
                url: '/energy/energyStructure/ring/getDataYZ',
                scale: 0.2,
                h:329,
                params: {
                    type: type,
                    date: date
                }
            }]
        }).init();
    }

    function showIndustry(type, date, e_type) {
        new yarn({
            charts: [{
                el: 'pie',
                type: 'pie',
                legend: '#legend_pie',
                url: '/energy/energyStructure/pie/getData',
                theme_obj: {
                    color: ["#9760e5", "#1890ff", "#2ec25b", "#facc14", "#ef4864"]
                },
                scale: 0.84,
                h:280,
                params: {
                    type: type,
                    date: date,
                    e_type: e_type,
                    key: 1
                }
            }]
        }).init();
    }

    function showArea(type, date, e_type) {
        new yarn({
            charts: [{
                el: 'ring',
                type: 'circle',
                theme: 'nolabel_ring',
                theme_obj: {
                    showLabel: false,
                    title: {
                        show: true,
                        text: '消耗总量',
                        textStyle: {
                            fontFamily: 'sans-serif',
                            color: "#666666",
                            height: 35,
                            fontSize: 16
                        },
                        subtextStyle: {
                            fontFamily: 'sans-serif',
                            color: "#262626",
                            height: 60,
                            fontSize: 26
                        }
                    }
                },
                url: '/energy/energyStructure/line/getDistrictYZ',
                // theme_obj: {
                //     color: ["#9760e5", "#1890ff", "#2ec25b", "#facc14", "#ef4864"]
                // },
                legend: '#legend_ring',
                scale: 0.84,
                h:280,
                params: {
                    type: type,
                    date: date,
                    e_type: e_type,
                    key: 1
                }
            }]
        }).init();
    }

    function initPage() {

        initDateInputForMonth('#date_input1_1');
        initDateInputForYear('#date_input1_2');
        initDateInputForMonth('#date_input2_1');
        initDateInputForYear('#date_input2_2');
        initDateInputForMonth('#date_input3_1');
        initDateInputForYear('#date_input3_2');

        $('#date_input1_1').val(getThisMonth());
        $('#date_input1_2').val(getThisYear());
        $('#date_input2_1').val(getThisMonth());
        $('#date_input2_2').val(getThisYear());
        $('#date_input3_1').val(getThisMonth());
        $('#date_input3_2').val(getThisYear());

        showTotal(type1, $('#date_input1_1').val());

        initSelectByUrl('energyType1', '/energy/enengyType/getEnergyConsumType?key=energyType1', function() {
            showIndustry(type2, $('#date_input2_1').val(), $('#energyType1').val());
        }, ['#energyType1']);

        initSelectByUrl('energyType2', '/energy/enengyType/getEnergyConsumType?key=energyType2', function() {
            showArea(type3, $('#date_input3_1').val(), $('#energyType2').val());
        }, ['#energyType2']);
    }

    $('#ser1').click(function() {
        if (type1 == 1) {
            var date = $('#date_input1_1').val();
        } else {
            var date = $('#date_input1_2').val();
        }
        showTotal(type1, date);
    });

    $('#ser2').click(function() {
        if (type2 == 1) {
            var date = $('#date_input2_1').val();
        } else {
            var date = $('#date_input2_2').val();
        }
        var e_type = $('#energyType1').val();
        showIndustry(type2, date, e_type);
    });

    $('#ser3').click(function() {
        if (type3 == 1) {
            var date = $('#date_input3_1').val();
        } else {
            var date = $('#date_input3_2').val();
        }
        var e_type = $('#energyType2').val();
        showArea(type3, date, e_type);
    });

    initPage();
</script>

</html>