<!DOCTYPE html>
<html>

<head>
    <title>能耗设备管理</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" id='theme' href="css/theme-dark-blue.css" />
</head>

<body>
    <div class="page-container">
        <a href="# " class="x-navigation-minimize menu_minimalize"><span class="arrow arrow-shrink "></span></a>
        <div class="page-sidebar page-sidebar-fixed scroll">
            <ul id='menu' class="x-navigation">
                <li class="xn-logo">
                    <a href="index.html"></a>
                    <a href='#' class="x-navigation-control "></a>
                </li>
            </ul>
        </div>
        <div class="page-content ">
            <h3 class="page-title">
                <ul class="x-navigation x-navigation-horizontal log-out pull-right">
                    <li class="xn-icon-button last ">
                        <a href="# "><span class="fa fa-power-off "></span></a>
                        <ul class="xn-drop-left animated zoomIn ">
                            <li><a href="# " class="mb-control " data-box="#mb-signout "><span class="fa fa-sign-out "></span> 登出</a></li>
                        </ul>
                    </li>
                </ul>
                能耗设备管理</h3>
            <div class="page-content-wrap ">
                <div class="page-content-box gap24">
                    <div class="clearfix mytbar">
                        <div id="inputBox" class="gap-btn-group hidden-xs tbar" role="group">
                            <button type="button" title="新增客户" class="btn btn-label">
                                <span>企业名称：</span>
                            </button>
                            <!-- <div class="btn-group compact" role="group">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    企业名称
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#" data-field='enterprise_name' data-placeholder='请输入企业名称'>企业名称</a></li>
                                </ul>
                            </div> -->
                            <select id="company" class="form-control select iselect w300"></select>
                            <button id="search_btn" type="button" title="搜索" class="btn btn-outline btn-primary">
                                <span>查询</span>
                            </button>
                        </div>
                        <div class="btn-group hidden-xs tbar pull-right" role="group">
                            <button id="add" data-table="TContact" type="button" title="新增" class="btn btn-outline btn-primary pull-right">
                                <span>新增</span>
                            </button>
                        </div>
                    </div>
                    <table id="TContact" data-height="708" data-mobile-responsive="true">
                        <thead>
                            <tr class="hidden-em">
                                <th data-field="state" data-checkbox="true" data-align="center" data-valign="middle"></th>
                                <th data-field="id" data-align="center" data-valign="middle">ID</th>
                                <th data-field="enterprise_name" data-valign="middle">企业名称</th>
                                <th data-field="area_name" data-valign="middle">所属区域</th>
                                <th data-field="industry_name" data-valign="middle">所属行业</th>
                                <th data-field="equipment_name" data-valign="middle">设备名称</th>
                                <th data-field="equipment_type" data-valign="middle">设备型号</th>
                                <th data-field="equipment_num" data-align="right" data-valign="middle">设备数量</th>
                                <th data-field="equipment_power" data-align="right" data-valign="middle">设备功率</th>
                                <th data-field="is_weedout" data-formatter="TFormatter" data-valign="middle">是否淘汰</th>
                                <th data-field="start_year1" data-formatter="DateFormatter" data-align="right" data-valign="middle">启用年限</th>
                                <!-- <th data-field="installation_site" data-valign="middle">安装地点</th> -->
                                <th data-field="person" data-valign="middle">责任人</th>
                                <th data-field="phone" data-align="right" data-valign="middle">联系电话</th>
                                <th data-field="equipment_picture1" data-formatter="ImageFormatter" data-align="center" data-valign="middle">设备图片</th>
                                <!-- <th data-field="remark" data-valign="middle">备注</th> -->
                                <th data-field="operate" data-formatter="OperatingFomatter" data-align="right" data-valign="middle">操作</th>
                            </tr>
                        </thead>
                    </table>
                    <div id="footerbar" class="footerbar hidden-em">
                        <div class="gap-btn-group" role="group">
                            <button id="checkall" type="button" class="btn btn-outline btn-default" data-cked="unchecked">
                                <span>全选</span>
                            </button>
                            <button id="bedit" type="button" class="btn btn-outline btn-primary">
                                <span>批量操作</span>
                            </button>
                            <button id="bdel" type="button" title="删除客户" class="btn btn-outline btn-primary">
                                <span>删除</span>
                            </button>
                            <button id="endState" type="button" title="删除客户" class="btn btn-outline btn-primary">
                                <span>完成</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="message-box animated fadeIn" data-sound="alert " id='mb-signout'>
        <div class="mb-container ">
            <div class="mb-middle ">
                <div class="mb-title"><span class="fa fa-sign-out "></span> Log <strong>Out</strong> ?</div>
                <div class="mb-content ">
                    <p>确定登出?</p>
                    <p>如果您想继续留在此页面，请点击"否"</p>
                </div>
                <div class="mb-footer ">
                    <div class="pull-right ">
                        <a href="login.html " class="btn btn-success btn-lg ">是</a>
                        <button class="btn btn-default btn-lg mb-control-close ">否</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="modal" class="modal fade">
        <div class="modal-dialog">
            <form action="javascript:void(0)" data-bv-message="验证未通过" data-bv-feedbackicons-valid="glyphicon glyphicon-ok" data-bv-feedbackicons-invalid="glyphicon glyphicon-remove" data-bv-feedbackicons-validating="glyphicon glyphicon-refresh">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title"></h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group hidden-em">
                            <label>id</label>
                            <input type="text" class="form-control" name="id">
                        </div>
                        <div class="form-group">
                            <label><span class="text-red">*</span>企业名称 </label>
                            <select id="enterprise" name="enterprise_id" class="form-control select" required></select>
                        </div>
                        <div class="form-group">
                            <label><span class="text-red">*</span>所属区域</label>
                            <select id="area" class="form-control" name="area_code" required></select>
                        </div>
                        <div class="form-group">
                            <label><span class="text-red">*</span>所属行业 </label>
                            <select id="industryCode" class="form-control" name="industry_code" required></select>
                        </div>
                        <div class="form-group">
                            <label>设备名称 </label>
                            <input type="text" class="form-control" name="equipment_name">
                        </div>
                        <div class="form-group">
                            <label>设备型号 </label>
                            <input type="text" class="form-control" name="equipment_type">
                        </div>
                        <div class="form-group">
                            <label>设备功率 </label>
                            <input type="text" class="form-control" name="equipment_power">
                        </div>
                        <div class="form-group">
                            <label>设备数量 </label>
                            <input type="text" class="form-control" name="equipment_num">
                        </div>
                        <div class="form-group">
                            <label>责任人 </label>
                            <input type="text" class="form-control" name="person">
                        </div>
                        <div class="form-group">
                            <label>联系电话 </label>
                            <input type="text" class="form-control" name="phone">
                        </div>
                        <div class="form-group">
                            <label>安装地点 </label>
                            <input type="text" class="form-control" name="installation_site">
                        </div>
                        <div class="form-group">
                            <label>启用年限 </label>
                            <input id="start_year1" type="text" class="form-control laydate-icon layer-date" name="start_year1">
                        </div>
                        <div class="form-group">
                            <label>设备概况 </label>
                            <input type="text" class="form-control" name="equipment_survey">
                        </div>
                        <div class="form-group">
                            <label>设备运行状况 </label>
                            <input type="text" class="form-control" name="equipment_operation">
                        </div>
                        <div class="form-group">
                            <label>淘汰更新状况 </label>
                            <input type="text" class="form-control" name="elimination_update">
                        </div>
                        <div class="form-group">
                            <label>是否淘汰 </label>
                            <select class="form-control select" name="is_weedout">
                                <option value="0">否</option>
                                <option value="1">是</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>设备图片 </label>
                            <input type="file" class="file" id="file" name="file" data-field="equipment_picture" />
                            <input type="hidden" name="equipment_picture" class="returnFile" />
                        </div>
                        <div class="form-group">
                            <label>备注 </label>
                            <input type="text" class="form-control" name="remark">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default cancel" data-dismiss="modal">取&nbsp;&nbsp;消</button>
                        <button type="button" class="btn btn-primary submit">保&nbsp;&nbsp;存</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div id='detail' class="modal fade">
        <div class="modal-dialog">
            <form action="javascript:void(0)">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title"></h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group hidden-em">
                            <label>id</label>
                            <input type="text" class="form-control" name="id">
                        </div>
                        <div class="form-group">
                            <label><span class="text-red">*</span>企业名称 </label>
                            <select id="enterprise1" name="enterprise_id" class="form-control select"></select>
                        </div>
                        <div class="form-group">
                            <label>所属区域</label>
                            <select id="area1" class="form-control" name="area_code"></select>
                        </div>
                        <div class="form-group">
                            <label>所属行业 </label>
                            <select id="industryCode1" class="form-control" name="industry_code"></select>
                        </div>
                        <div class="form-group">
                            <label>设备名称 </label>
                            <input type="text" class="form-control" name="equipment_name">
                        </div>
                        <div class="form-group">
                            <label>设备型号 </label>
                            <input type="text" class="form-control" name="equipment_type">
                        </div>
                        <div class="form-group">
                            <label>设备功率 </label>
                            <input type="text" class="form-control" name="equipment_power">
                        </div>
                        <div class="form-group">
                            <label>设备数量 </label>
                            <input type="text" class="form-control" name="equipment_num">
                        </div>
                        <div class="form-group">
                            <label>责任人 </label>
                            <input type="text" class="form-control" name="person">
                        </div>
                        <div class="form-group">
                            <label>联系电话 </label>
                            <input type="text" class="form-control" name="phone">
                        </div>
                        <div class="form-group">
                            <label>安装地点 </label>
                            <input type="text" class="form-control" name="installation_site">
                        </div>
                        <div class="form-group">
                            <label>启用年限 </label>
                            <input id="start_year1" type="text" class="form-control laydate-icon layer-date" name="start_year1">
                        </div>
                        <div class="form-group">
                            <label>设备概况 </label>
                            <input type="text" class="form-control" name="equipment_survey">
                        </div>
                        <div class="form-group">
                            <label>设备运行状况 </label>
                            <input type="text" class="form-control" name="equipment_operation">
                        </div>
                        <div class="form-group">
                            <label>淘汰更新状况 </label>
                            <input type="text" class="form-control" name="elimination_update">
                        </div>
                        <div class="form-group">
                            <label>是否淘汰 </label>
                            <select class="form-control select" name="is_weedout">
                                <option value="0">否</option>
                                <option value="1">是</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>设备图片 </label>
                            <img name="equipment_picture1">
                        </div>
                        <div class="form-group">
                            <label>备注 </label>
                            <input type="text" class="form-control" name="remark">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn  btn-primary submit" data-dismiss="modal">确&nbsp;&nbsp;认</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</body>
<script type='text/javascript' src="js/import.js"></script>
<script type='text/javascript' src="js/pages/common.js"></script>
<script type='text/javascript' src="js/pages/CURDTable.js"></script>
<script>
    function initCompanySelectByElementId(e_id, completeHandler) {

        var childSls = {};
        childSls['#' + e_id] = {
            url: '/energy/enterprise/getNameList?key=company',
            def: '全部企业',
            type: 'GET',
            showDef: true
        };

        var sc = new cur({
            childSls: childSls
        });

        sc.initSelect();

        sc.on('select:render.complete', function() {
            checkFirstAsDefault($('#' + e_id));

            if (_.isFunction(completeHandler)) {
                completeHandler($('#' + e_id).val());
            }
        });
    }

    initCompanySelectByElementId('company', function(value) {
        initCur(value);
    });

    $('#search_btn').on('click', function() {
        initCur($('#company').val());
    })

    function initCur(id) {
        var c = new cur({
            t: "#TContact",
            m: "#modal",
            footerbar: '#footerbar',
            showAfterRender: ['#footerbar'],
            pageSize: 7,
            height: 730,
            dataInputs: ["#start_year1"],
            hideCols: ['id'],
            childSls: {
                "#area": {
                    def: '--请选择区域--',
                    url: '/energy/energyEquipment/getAreaList?key=area&code=321000',
                    autoRef: 'true',
                    type: 'GET'
                },
                "#enterprise": {
                    def: '--请选择企业--',
                    url: '/energy/enterprise/getNameList?key=enterprise',
                    autoRef: 'true',
                    type: 'GET'
                },
                "#industryCode": {
                    def: '--请选择所属行业--',
                    url: '/energy/energyEquipment/getIndustryList?key=industryCode',
                    autoRef: 'true',
                    type: 'GET'
                },
                "#area1": {
                    def: '--请选择区域--',
                    url: '/energy/energyEquipment/getAreaList?key=area1&code=321000',
                    autoRef: 'true',
                    type: 'GET'
                },
                "#enterprise1": {
                    def: '--请选择企业--',
                    url: '/energy/enterprise/getNameList?key=enterprise1',
                    autoRef: 'true',
                    type: 'GET'
                },
                "#industryCode1": {
                    def: '--请选择所属行业--',
                    url: '/energy/energyEquipment/getIndustryList?key=industryCode1',
                    autoRef: 'true',
                    type: 'GET'
                },
            },
            search_params: {
                field_select: '#field_select',
                field_input: '#search_input'
            },
            queryUrl: "/energy/energyEquipment/getList",
            addUrl: "/energy/energyEquipment/add",
            editUrl: "/energy/energyEquipment/update",
            delUrl: "/energy/energyEquipment/delByIds ",
            params: {
                params: {
                    enterprise_id: id
                }
            }
        });
        c.init(c);
    }
</script>

</html>